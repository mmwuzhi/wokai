(this.webpackJsonpwokai=this.webpackJsonpwokai||[]).push([[0],{57:function(e,t,n){},92:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n(43),i=n.n(a),c=n(14),o=n(7),r=(n(56),n(57),n(3)),l=n(4),m=n(6),u=n(5),h=n(8),d=n.n(h),j=n(51),b=n(0),p=Object(s.createContext)(),v=p.Provider,f=p.Consumer,O=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={user:{},doLogout:null,doLogin:null,error:null,Signed:!1,onLoading:!0},e.selectMessageHandler=function(t){e.setState({currentMessage:t})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({login:!1,error:null}),d.a.get("/api/users/userInfo").then((function(t){0===t.data.code?e.setState({onLoading:!1,Signed:!0,user:t.data}):e.setState({onLoading:!1,Signed:!1})})).catch((function(t){return e.setState({onLoading:!1,Signed:!1,error:t})}))}},{key:"render",value:function(){return Object(b.jsx)(v,{value:Object(j.a)({},this.state),children:this.props.children})}}]),n}(s.Component),g=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("nav",{className:"navbar navbar-dark bg-info navbar-expand-lg shadow",children:[Object(b.jsxs)(c.b,{to:"/",className:"navbar-brand",children:["\u306a\u3093\u3067\u3082\u3055\u3044\u3068"," "]}),Object(b.jsx)("div",{className:"collpase navbar-collapse",children:Object(b.jsxs)("ul",{className:"navbar-nav mr-auto",children:[Object(b.jsx)("li",{className:"navbar-item",children:Object(b.jsx)(c.c,{to:"/",exact:!0,activeClassName:"active",className:"nav-link",children:"\u30db\u30fc\u30e0\u30da\u30fc\u30b8"})}),Object(b.jsx)("li",{className:"navbar-item",children:Object(b.jsx)(c.c,{to:"/comment",exact:!0,activeClassName:"active",className:"nav-link",children:"\u30b3\u30e1\u30f3\u30c8"})}),this.props.Signed?Object(b.jsx)("li",{className:"navbar-item",children:Object(b.jsx)(c.c,{to:"/user/mypage",activeClassName:"active",className:"nav-link",children:"\u30de\u30a4\u30da\u30fc\u30b8"})}):Object(b.jsx)("li",{className:"navbar-item",children:Object(b.jsx)(c.c,{to:"/user/signup",activeClassName:"active",className:"nav-link",children:"\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7"})}),this.props.Signed?Object(b.jsx)("li",{className:"navbar-item",children:Object(b.jsx)(c.c,{to:"/user/logout",activeClassName:"active",className:"nav-link",children:"\u30ed\u30b0\u30a2\u30a6\u30c8"})}):Object(b.jsx)("li",{className:"navbar-item",children:Object(b.jsx)(c.c,{to:"/user/login",activeClassName:"active",className:"nav-link",children:"\u30ed\u30b0\u30a4\u30f3"})})]})})]})}}]),n}(s.Component);function x(){return Object(b.jsx)(f,{children:function(e){return Object(b.jsx)(g,{Signed:e.Signed})}})}var C=n(50);function y(){var e=Object(s.useState)(0),t=Object(C.a)(e,2),n=t[0],a=t[1];return Object(s.useEffect)((function(){document.title="You clicked ".concat(n," times")})),Object(b.jsxs)("div",{children:[Object(b.jsxs)("p",{children:["You clicked ",n," times"]}),Object(b.jsx)("button",{onClick:function(){return a(n+1)},children:"Click me"})]})}var N=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={username:"",content:""},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.textarea.focus()}},{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handleContentChange",value:function(e){this.setState({content:e.target.value})}},{key:"handleSubmit",value:function(e){if(e.preventDefault(),this.props.onSubmit){var t=this.state,n=t.username,s=t.content,a=this.props.email;this.props.onSubmit({username:n,email:a,content:s,createdTime:+new Date})}this.setState({content:""})}},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{className:"comment-input",children:[Object(b.jsxs)("div",{className:"comment-field",children:[Object(b.jsx)("span",{className:"comment-field-name",children:"\u30e6\u30fc\u30b6\u540d\uff1a"}),Object(b.jsx)("div",{className:"comment-field-input",children:Object(b.jsx)("input",{value:this.state.username,onChange:this.handleUsernameChange.bind(this)})})]}),Object(b.jsxs)("div",{className:"comment-field",children:[Object(b.jsx)("span",{className:"comment-field-name",children:"\u30b3\u30e1\u30f3\u30c8\uff1a"}),Object(b.jsx)("div",{className:"comment-field-input",children:Object(b.jsx)("textarea",{ref:function(t){return e.textarea=t},value:this.state.content,onChange:this.handleContentChange.bind(this)})})]}),Object(b.jsx)("div",{className:"comment-field-button",children:Object(b.jsx)("button",{onClick:this.handleSubmit.bind(this),children:"\u6295\u7a3f"})})]})}}]),n}(s.Component),S=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"handleDeleteComment",value:function(){this.props.onDeleteComment&&this.props.onDeleteComment(this.props.id)}},{key:"render",value:function(){return Object(b.jsx)("span",{onClick:this.handleDeleteComment.bind(this),className:"comment-delete",children:"\u524a\u9664"})}}]),n}(s.Component),w=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={timeString:""},s}return Object(l.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){this._updateTimeString(),this._timer=setInterval(this._updateTimeString.bind(this),6e4)}},{key:"componentWillUnmount",value:function(){clearInterval(this._timer)}},{key:"getDate",value:function(e){var t=new Date(e);return"".concat(t.getFullYear(),"\u5e74").concat(t.getMonth()+1,"\u6708").concat(t.getDate(),"\u65e5 ").concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds())}},{key:"_updateTimeString",value:function(){var e=this.props.comment,t=(+Date.now()-e.createdTime)/1e3;this.setState({timeString:t>60?t>3600?t>86400?this.getDate(e.createdTime):"".concat(Math.round(t/3600)," \u6642\u9593\u524d"):"".concat(Math.round(t/60)," \u5206\u524d"):"".concat(Math.round(Math.max(t,1))," \u79d2\u524d")})}},{key:"_getProcessedContent",value:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/`([\S\s]+?)`/g,"<code>$1</code>")}},{key:"handleDeleteComment",value:function(){this.props.onDeleteComment&&this.props.onDeleteComment(this.props.comment._id)}},{key:"render",value:function(){var e=this.props.comment;return Object(b.jsxs)("div",{className:"comment",children:[Object(b.jsxs)("div",{className:"comment-user",children:[Object(b.jsx)("span",{children:e.username}),"\uff1a"]}),Object(b.jsx)("span",{className:"comment-createdtime",children:this.state.timeString}),Object(b.jsx)("p",{dangerouslySetInnerHTML:{__html:this._getProcessedContent(e.content)}}),""!==e.email&&Object(b.jsx)(S,{onDeleteComment:this.handleDeleteComment.bind(this),id:e.id})]})}}]),n}(s.Component),k=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"handleDeleteComment",value:function(e){this.props.onDeleteComment&&this.props.onDeleteComment(e)}},{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{children:this.props.comments.map((function(t,n){return(t.email===e.props.email||""===t.email)&&Object(b.jsx)(w,{comment:t,index:n,onDeleteComment:e.handleDeleteComment.bind(e)},n)}))})}}]),n}(s.Component);k.defaultProps={comments:[]};var D=k,P=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={comments:[],isShowCommentList:!0,isShowClock:!0,username:"",email:"",style:{width:"105px",fontSize:"12px",marginRight:"10px"}},d.a.get("/api/users/userInfo").then((function(e){0===e.data.code&&s.setState({username:e.data.data.username,email:e.data.data.email})})),s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;d.a.get("/api/comments/").then((function(t){e.setState({comments:t.data})})).catch((function(e){console.log(e)}))}},{key:"handleShowOrCommentList",value:function(){this.setState({isShowCommentList:!this.state.isShowCommentList})}},{key:"handleSubmitComment",value:function(e){if(e)return e.username?e.content?void d.a.post("/api/comments/add",e).then(this.componentDidMount.bind(this)).catch((function(e){console.log(e)})):alert("\u30b3\u30e1\u30f3\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff01"):alert("\u30e6\u30fc\u30b6\u540d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff01")}},{key:"handleDeleteComment",value:function(e){d.a.delete("/api/comments/"+e).then((function(e){return console.log(e.data)})).catch((function(e){console.log(e)})),this.setState({comments:this.state.comments.filter((function(t){return t._id!==e}))})}},{key:"render",value:function(){return Object(b.jsxs)("div",{className:"wrapper",children:[Object(b.jsx)(N,{onSubmit:this.handleSubmitComment.bind(this),username:this.state.username,email:this.state.email}),Object(b.jsx)(D,{comments:this.state.comments,onDeleteComment:this.handleDeleteComment.bind(this),email:this.state.email})]})}}]),n}(s.Component),L=n(16),M=n(94),_=function(){return Object(b.jsx)("div",{className:"loading",children:Object(b.jsx)(M.a,{size:"large"})})},I=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).onSubmit=s.onSubmit.bind(Object(L.a)(s)),s.state={username:"",email:"",password:"",confirmPassword:"",message:"",onLoading:!0},d.a.get("/api/users/userInfo").then((function(e){0===e.data.code?s.props.history.push("/user/mypage"):s.setState({onLoading:!1})})),s}return Object(l.a)(n,[{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onChangeConfirmPassword",value:function(e){this.setState({confirmPassword:e.target.value})}},{key:"onSubmit",value:function(e){var t=this;if(e.preventDefault(),this.state.password!==this.state.confirmPassword)this.setState({message:"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\uff01"});else{var n={username:this.state.username,email:this.state.email,password:this.state.password};this.setState({message:""}),d.a.post("/api/users/",n).then((function(){alert("\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7\u3057\u307e\u3057\u305f\uff01"),t.props.history.push("/comment")})).catch((function(e){console.log(e),alert(e)}))}}},{key:"render",value:function(){return Object(b.jsxs)("div",{children:[this.state.onLoading&&Object(b.jsx)(_,{}),Object(b.jsx)("h3",{className:"mt-3 mb-5",children:"\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7"}),Object(b.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0: "}),Object(b.jsx)("input",{type:"text",className:"form-control mt-2 mb-4",value:this.state.username,onChange:this.onChangeUsername.bind(this)})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9: "}),Object(b.jsx)("input",{type:"email",className:"form-control mt-2 mb-4",value:this.state.email,onChange:this.onChangeEmail.bind(this)})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u30d1\u30b9\u30ef\u30fc\u30c9: "}),Object(b.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",value:this.state.password,onChange:this.onChangePassword.bind(this)})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u30d1\u30b9\u30ef\u30fc\u30c9\u78ba\u8a8d: "}),Object(b.jsx)("span",{style:{color:"red"},children:this.state.message}),Object(b.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",value:this.state.confirmPassword,onChange:this.onChangeConfirmPassword.bind(this)})]}),Object(b.jsx)("div",{className:"form-group",children:Object(b.jsx)("input",{type:"submit",value:"\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7",className:"btn btn-info"})})]})]})}}]),n}(s.Component),U=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).onSubmit=s.onSubmit.bind(Object(L.a)(s)),s.state={username:"",email:"",password:"",newPassword:"",confirmNewPassword:"",errorMessage:"",message:""},d.a.get("/api/users/userInfo").then((function(e){0===e.data.code?s.setState({username:e.data.data.username,email:e.data.data.email}):s.props.history.push("/user/login")})),s}return Object(l.a)(n,[{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onChangeNewPassword",value:function(e){this.setState({newPassword:e.target.value})}},{key:"onChangeNewConfirmPassword",value:function(e){this.setState({confirmNewPassword:e.target.value})}},{key:"onSubmit",value:function(e){var t=this;if(e.preventDefault(),this.state.newPassword!==this.state.confirmNewPassword)this.setState({message:"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\uff01"});else{var n={username:this.state.username,email:this.state.email,password:this.state.password,newPassword:this.state.newPassword};this.setState({message:""}),d.a.post("/api/users/update",n).then((function(){alert("\u5909\u66f4\u3057\u307e\u3057\u305f\uff01"),t.props.history.push("/comment")})).catch((function(e){t.setState({errorMessage:"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9593\u9055\u3044\u307e\u3057\u305f\uff01"}),alert(e)}))}}},{key:"render",value:function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{className:"mt-3 mb-5",children:"\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u5909\u66f4"}),Object(b.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0: "}),Object(b.jsx)("input",{type:"text",className:"form-control mt-2 mb-4",value:this.state.username,onChange:this.onChangeUsername.bind(this)})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9: "}),Object(b.jsx)("span",{children:this.state.email})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u30d1\u30b9\u30ef\u30fc\u30c9: "}),Object(b.jsx)("span",{style:{color:"red"},children:this.state.errorMessage}),Object(b.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",value:this.state.password,onChange:this.onChangePassword.bind(this)})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u65b0\u30d1\u30b9\u30ef\u30fc\u30c9: "}),Object(b.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",value:this.state.newPassword,onChange:this.onChangeNewPassword.bind(this)})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u65b0\u30d1\u30b9\u30ef\u30fc\u30c9\u78ba\u8a8d: "}),Object(b.jsx)("span",{style:{color:"red"},children:this.state.message}),Object(b.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",value:this.state.confirmNewPassword,onChange:this.onChangeNewConfirmPassword.bind(this)})]}),Object(b.jsx)("div",{className:"form-group",children:Object(b.jsx)("input",{type:"submit",value:"\u5909\u66f4",className:"btn btn-info"})})]})]})}}]),n}(s.Component),E=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).onSubmit=s.onSubmit.bind(Object(L.a)(s)),s.state={email:"",password:"",code:1,onLoading:!0},d.a.get("/api/users/userInfo").then((function(e){0===e.data.code?s.props.history.push("/comment"):s.setState({onLoading:!1})})),s}return Object(l.a)(n,[{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var n={email:this.state.email,password:this.state.password};d.a.post("/api/users/login",n).then((function(e){t.setState({data:e.data})})).then((function(){console.log("\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3057\u305f\uff01"),t.props.history.push("/comment")})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return Object(b.jsxs)("div",{children:[this.state.onLoading&&Object(b.jsx)(_,{}),Object(b.jsx)("h3",{className:"mt-3 mb-5",children:"\u30ed\u30b0\u30a4\u30f3"}),Object(b.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9: "}),Object(b.jsx)("input",{type:"email",className:"form-control mt-2 mb-4",value:this.state.email,onChange:this.onChangeEmail.bind(this)})]}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("label",{children:"\u30d1\u30b9\u30ef\u30fc\u30c9: "}),Object(b.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",value:this.state.password,onChange:this.onChangePassword.bind(this)})]}),Object(b.jsx)("div",{className:"form-group",children:Object(b.jsx)("input",{type:"submit",value:"\u30b5\u30a4\u30f3\u30a4\u30f3",className:"btn btn-info"})})]})]})}}]),n}(s.Component),T=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={code:1,display:"block"},d.a.get("/api/users/userInfo").then((function(e){0===e.data.code?s.setState({display:"none"}):s.props.history.push("/user/login")})),s}return Object(l.a)(n,[{key:"cancel",value:function(){this.props.history.push("/")}},{key:"logout",value:function(){var e=this;d.a.get("/api/users/logout").then((function(t){"1"===t.data.logout&&e.props.history.push("/")}))}},{key:"render",value:function(){return Object(b.jsxs)("div",{children:[this.state.onLoading&&Object(b.jsx)(_,{}),Object(b.jsx)("h3",{className:"mt-3 mb-5",children:"\u30ed\u30b0\u30a2\u30a6\u30c8"}),Object(b.jsx)("span",{className:"form-group",children:"\u306a\u3093\u3067\u3082\u3055\u3044\u3068\u304b\u3089\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3059\u304b\uff1f"}),Object(b.jsxs)("div",{className:"form-group",children:[Object(b.jsx)("button",{onClick:this.cancel.bind(this),className:"btn btn-info",style:{backgroundColor:"lightgray",borderColor:"lightgray"},children:"\u30ad\u30e3\u30f3\u30bb\u30eb"}),Object(b.jsx)("button",{onClick:this.logout.bind(this),className:"btn btn-info",children:"\u30ed\u30b0\u30a2\u30a6\u30c8"})]})]})}}]),n}(s.Component);var H=function(){return Object(b.jsx)(c.a,{children:Object(b.jsxs)("div",{className:"container",children:[Object(b.jsx)(x,{}),Object(b.jsx)("br",{}),Object(b.jsx)(o.a,{path:"/",exact:!0,component:y}),Object(b.jsx)(o.a,{path:"/comment",component:P}),Object(b.jsx)(o.a,{path:"/user/signup",component:I}),Object(b.jsx)(o.a,{path:"/user/mypage",component:U}),Object(b.jsx)(o.a,{path:"/user/login",component:E}),Object(b.jsx)(o.a,{path:"/user/logout",component:T})]})})};n(91);i.a.render(Object(b.jsx)(O,{children:Object(b.jsx)(H,{})}),document.getElementById("root"))}},[[92,1,2]]]);
//# sourceMappingURL=main.4044d095.chunk.js.map