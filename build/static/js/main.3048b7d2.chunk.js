(this.webpackJsonpwokai=this.webpackJsonpwokai||[]).push([[0],{54:function(e,t,c){},90:function(e,t,c){"use strict";c.r(t);var n,a=c(0),s=c(42),r=c.n(s),o=c(12),l=c(5),i=(c(53),c(54),c(3)),u=c(4),j="USER_LOGIN_REQUEST",b="USER_LOGIN_SUCCESS",m="USER_LOGIN_FAIL",d="USER_LOGOUT_REQUEST",O="USER_LOGOUT_SUCCESS",f="USER_LOGOUT_FAIL",p="USER_CHECK_LOGGED_REQUEST",h="USER_CHECK_LOGGED_SUCCESS",v="USER_CHECK_LOGGED_FAIL",x="USER_SIGNUP_REQUEST",g="USER_SIGNUP_SUCCESS",N="USER_SIGNUP_FAIL",S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case b:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,logged:!0,userData:t.value});case m:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,error:t.value});case d:return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case O:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,logged:!1,userData:{}});case f:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,error:t.value});case p:return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case h:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,logged:!0,userData:t.value});case v:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,error:t.value});case x:return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case g:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,logged:!0,userData:t.value});case N:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,error:t.value});default:return e}},C=c(16),y=c.n(C),E=c(24),_=c(7),U=c.n(_),w=c(92),k=c(1),D=function(){return Object(k.jsx)("div",{className:"loading",children:Object(k.jsx)(w.a,{size:"large"})})},R=n=Object(a.createContext)(),I=R.Provider,G=(R.Consumer,{userData:{},error:null,logged:!1,loading:!0}),L=function(e){var t=Object(a.useReducer)(S,G),c=Object(i.a)(t,2),n=c[0],s=c[1];return Object(a.useEffect)((function(){!function(e){e({type:p}),U.a.get("/api/users/userInfo").then((function(t){0===t.data.code?e({type:h,value:t.data.data}):e({type:v})})).catch((function(t){console.log(t),e({type:v})}))}(s)}),[]),Object(k.jsxs)(I,{value:{state:n,dispatch:s},children:[n.loading&&Object(k.jsx)(D,{}),e.children]})},T=function(){var e=Object(a.useContext)(n).state;return Object(k.jsxs)("nav",{className:"navbar navbar-dark bg-info navbar-expand-lg shadow",children:[Object(k.jsx)(o.b,{to:"/",className:"navbar-brand",children:"\u306a\u306b\u306a\u306b\u3055\u3044\u3068"}),Object(k.jsx)("div",{className:"collpase navbar-collapse",children:Object(k.jsxs)("ul",{className:"navbar-nav mr-auto",children:[Object(k.jsx)("li",{className:"navbar-item",children:Object(k.jsx)(o.c,{to:"/",exact:!0,activeClassName:"active",className:"nav-link",children:"\u30db\u30fc\u30e0\u30da\u30fc\u30b8"})}),Object(k.jsx)("li",{className:"navbar-item",children:Object(k.jsx)(o.c,{to:"/comment",exact:!0,activeClassName:"active",className:"nav-link",children:"\u30b3\u30e1\u30f3\u30c8"})}),e.logged?Object(k.jsx)("li",{className:"navbar-item",children:Object(k.jsx)(o.c,{to:"/user/mypage",activeClassName:"active",className:"nav-link",children:"\u30de\u30a4\u30da\u30fc\u30b8"})}):Object(k.jsx)("li",{className:"navbar-item",children:Object(k.jsx)(o.c,{to:"/user/signup",activeClassName:"active",className:"nav-link",children:"\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7"})}),e.logged?Object(k.jsx)("li",{className:"navbar-item",children:Object(k.jsx)(o.c,{to:"/user/logout",activeClassName:"active",className:"nav-link",children:"\u30ed\u30b0\u30a2\u30a6\u30c8"})}):Object(k.jsx)("li",{className:"navbar-item",children:Object(k.jsx)(o.c,{to:"/user/login",activeClassName:"active",className:"nav-link",children:"\u30ed\u30b0\u30a4\u30f3"})})]})})]})};function M(){var e=Object(a.useState)(0),t=Object(i.a)(e,2),c=t[0],n=t[1];return Object(a.useEffect)((function(){document.title="You clicked ".concat(c," times")})),Object(k.jsxs)("div",{children:[Object(k.jsxs)("p",{children:["You clicked ",c," times"]}),Object(k.jsx)("button",{onClick:function(){return n(c+1)},children:"Click me"})]})}var F=function(e){var t=Object(a.useContext)(n).state,c=Object(a.useState)(""),s=Object(i.a)(c,2),r=s[0],o=s[1],l=Object(a.useState)(""),u=Object(i.a)(l,2),j=u[0],b=u[1],m=Object(a.useRef)(null),d=Object(a.useRef)(null);Object(a.useEffect)((function(){U.a.get("/api/users/userInfo").then((function(e){0===e.data.code?(o(e.data.data.username),m.current.focus()):d.current.focus()}))}),[]);return Object(k.jsxs)("div",{className:"comment-input",children:[Object(k.jsxs)("div",{className:"comment-field",children:[Object(k.jsx)("span",{className:"comment-field-name",children:"\u30e6\u30fc\u30b6\u540d\uff1a"}),Object(k.jsx)("div",{className:"comment-field-input",children:Object(k.jsx)("input",{value:r,ref:d,onChange:function(e){return o(e.target.value)}})})]}),Object(k.jsxs)("div",{className:"comment-field",children:[Object(k.jsx)("span",{className:"comment-field-name",children:"\u30b3\u30e1\u30f3\u30c8\uff1a"}),Object(k.jsx)("div",{className:"comment-field-input",children:Object(k.jsx)("textarea",{ref:m,value:j,onChange:function(e){return b(e.target.value)}})})]}),Object(k.jsx)("div",{className:"comment-field-button",children:Object(k.jsx)("button",{onClick:function(c){return function(c){if(c.preventDefault(),e.onSubmit){var n=t.userData.email;e.onSubmit({username:r,email:n,content:j,createdTime:+new Date})}b("")}(c)},children:"\u6295\u7a3f"})})]})},H=function(e){var t=Object(a.useState)(""),c=Object(i.a)(t,2),n=c[0],s=c[1],r=Object(a.useRef)();Object(a.useEffect)((function(){return l(),r.current=setInterval(l,6e4),function(){clearInterval(r.current)}}));var o,l=function(){var t=e.comment,c=(+Date.now()-t.createdTime)/1e3;s(c>60?c>3600?c>86400?function(e){var t=new Date(e);return"".concat(t.getFullYear(),"\u5e74").concat(t.getMonth()+1,"\u6708").concat(t.getDate(),"\u65e5 ").concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds())}(t.createdTime):"".concat(Math.round(c/3600)," \u6642\u9593\u524d"):"".concat(Math.round(c/60)," \u5206\u524d"):"".concat(Math.round(Math.max(c,1))," \u79d2\u524d"))};return Object(k.jsxs)("div",{className:"comment",children:[Object(k.jsxs)("div",{className:"comment-user",children:[Object(k.jsx)("span",{children:e.comment.username}),"\uff1a"]}),Object(k.jsx)("span",{className:"comment-createdtime",children:n}),Object(k.jsx)("p",{dangerouslySetInnerHTML:{__html:(o=e.comment.content,o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/`([\S\s]+?)`/g,"<code>$1</code>"))}}),!!e.comment.email&&Object(k.jsx)("span",{onClick:function(){e.onDeleteComment&&e.onDeleteComment(e.comment._id)},className:"comment-delete",children:"\u524a\u9664"})]})},P=function(e){return Object(k.jsx)("div",{children:e.comments.map((function(t,c){return Object(k.jsx)(H,{comment:t,index:c,onDeleteComment:function(t){return function(t){e.onDeleteComment&&e.onDeleteComment(t)}(t)}},c)}))})},A=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),c=t[0],n=t[1];Object(a.useEffect)((function(){s()}),[]);var s=function(){U.a.get("/api/comments/").then((function(e){n(e.data)})).catch((function(e){console.error(e)}))};return Object(k.jsxs)("div",{className:"wrapper",children:[Object(k.jsx)(F,{onSubmit:function(e){return function(e){if(e)return e.username?e.content?void U.a.post("/api/comments/add",e).then(s).catch((function(e){console.log(e)})):alert("\u30b3\u30e1\u30f3\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff01"):alert("\u30e6\u30fc\u30b6\u540d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff01")}(e)}}),Object(k.jsx)(P,{comments:c,onDeleteComment:function(e){return function(e){U.a.delete("/api/comments/"+e).then((function(t){console.log(t.data),n(c.filter((function(t){return t._id!==e})))})).catch((function(e){console.log(e)}))}(e)}})]})},Q=function(e){var t=Object(a.useContext)(n),c=t.state,s=t.dispatch,r=Object(a.useState)(""),o=Object(i.a)(r,2),l=o[0],u=o[1],j=Object(a.useState)(""),b=Object(i.a)(j,2),m=b[0],d=b[1],O=Object(a.useState)(""),f=Object(i.a)(O,2),p=f[0],h=f[1],v=Object(a.useRef)(null),S=Object(a.useState)(""),C=Object(i.a)(S,2),_=C[0],w=C[1];Object(a.useEffect)((function(){!0===c.logged&&e.history.push("/user/mypage")}),[c.logged,e.history]);var D=function(e){if(p!==v.current.value)w({message:"\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\uff01"});else{var t={username:l,email:m,password:p};w(""),function(e){return function(){var t=Object(E.a)(y.a.mark((function t(c){var n,a;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,c({type:x}),t.next=4,U.a.post("/api/users/",e);case 4:n=t.sent,a=n.data,alert("\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7\u3057\u307e\u3057\u305f\uff01"),c({type:g,value:a}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),c({type:N,value:t.t0.response?t.t0.response.data.message:"errorMessage"});case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()}(t)(s)}};return Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{className:"mt-3 mb-5",children:"\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7"}),Object(k.jsxs)("form",{onSubmit:function(e){return D()},children:[Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0: "}),Object(k.jsx)("input",{type:"text",className:"form-control mt-2 mb-4",value:l,onChange:function(e){return u(e.target.value)}})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9: "}),Object(k.jsx)("input",{type:"email",className:"form-control mt-2 mb-4",value:m,onChange:function(e){return d(e.target.value)}})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u30d1\u30b9\u30ef\u30fc\u30c9: "}),Object(k.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",value:p,onChange:function(e){return h(e.target.value)}})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u30d1\u30b9\u30ef\u30fc\u30c9\u78ba\u8a8d: "}),Object(k.jsx)("span",{style:{color:"red"},children:_}),Object(k.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",ref:v})]}),Object(k.jsx)("div",{className:"form-group",children:Object(k.jsx)("input",{type:"submit",value:"\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7",className:"btn btn-info"})})]})]})},K=function(e){var t=Object(a.useContext)(n).state,c=Object(a.useState)(t.userData.username),s=Object(i.a)(c,2),r=s[0],o=s[1],l=Object(a.useState)(""),u=Object(i.a)(l,2),j=u[0],b=u[1],m=Object(a.useState)(""),d=Object(i.a)(m,2),O=d[0],f=d[1],p=Object(a.useRef)(null),h=Object(a.useState)(""),v=Object(i.a)(h,2),x=v[0],g=v[1],N=Object(a.useState)(""),S=Object(i.a)(N,2),C=S[0],y=S[1];Object(a.useEffect)((function(){!0!==t.logged&&e.history.push("/user/login")}),[t.logged,e.history]);return Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{className:"mt-3 mb-5",children:"\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u5909\u66f4"}),Object(k.jsxs)("form",{onSubmit:function(c){if(c.preventDefault(),O!==p.current.value)y("\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\uff01");else{var n={username:r,email:t.userData.email,password:j,newPassword:O};y(""),U.a.post("/api/users/update",n).then((function(){alert("\u5909\u66f4\u3057\u307e\u3057\u305f\uff01"),e.history.push("/comment")})).catch((function(e){console.table(e),g("\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9593\u9055\u3044\u307e\u3057\u305f\uff01")}))}},children:[Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0: "}),Object(k.jsx)("input",{type:"text",className:"form-control mt-2 mb-4",value:r,onChange:function(e){return o(e.target.value)}})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9: "}),Object(k.jsx)("span",{children:t.email})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u30d1\u30b9\u30ef\u30fc\u30c9: "}),Object(k.jsx)("span",{style:{color:"red"},children:x}),Object(k.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",value:j,onChange:function(e){return b(e.target.value)}})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u65b0\u30d1\u30b9\u30ef\u30fc\u30c9: "}),Object(k.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",value:O,onChange:function(e){return f(e.target.value)}})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u65b0\u30d1\u30b9\u30ef\u30fc\u30c9\u78ba\u8a8d: "}),Object(k.jsx)("span",{style:{color:"red"},children:C}),Object(k.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",ref:p})]}),Object(k.jsx)("div",{className:"form-group",children:Object(k.jsx)("input",{type:"submit",value:"\u5909\u66f4",className:"btn btn-info"})})]})]})},Y=function(e){var t=Object(a.useContext)(n),c=t.state,s=t.dispatch,r=Object(a.useState)(""),o=Object(i.a)(r,2),l=o[0],u=o[1],d=Object(a.useState)(""),O=Object(i.a)(d,2),f=O[0],p=O[1];Object(a.useEffect)((function(){!0===c.logged&&e.history.push("/comment")}),[c.logged,e.history]);var h=function(e){e.preventDefault(),function(e,t){return function(){var c=Object(E.a)(y.a.mark((function c(n){var a,s,r;return y.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,n({type:j}),a={email:e,password:t},c.next=5,U.a.post("/api/users/login",a);case 5:s=c.sent,r=s.data,n({type:b,value:r}),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(0),n({type:m,value:c.t0.response?c.t0.response.data.message:"errorMessage"});case 13:case"end":return c.stop()}}),c,null,[[0,10]])})));return function(e){return c.apply(this,arguments)}}()}(l,f)(s)};return Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{className:"mt-3 mb-5",children:"\u30ed\u30b0\u30a4\u30f3"}),Object(k.jsxs)("form",{onSubmit:function(e){return h(e)},children:[Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9: "}),Object(k.jsx)("input",{type:"email",className:"form-control mt-2 mb-4",value:l,onChange:function(e){return u(e.target.value)}})]}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{children:"\u30d1\u30b9\u30ef\u30fc\u30c9: "}),Object(k.jsx)("input",{type:"password",className:"form-control mt-2 mb-4",value:f,onChange:function(e){return p(e.target.value)}})]}),Object(k.jsx)("div",{className:"form-group",children:Object(k.jsx)("input",{type:"submit",value:"\u30b5\u30a4\u30f3\u30a4\u30f3",className:"btn btn-info"})})]})]})},J=function(e){var t=Object(a.useContext)(n),c=t.state,s=t.dispatch;Object(a.useEffect)((function(){!1===c.logged&&e.history.push("/user/login")}),[c.logged,e.history]);return Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{className:"mt-3 mb-5",children:"\u30ed\u30b0\u30a2\u30a6\u30c8"}),Object(k.jsx)("span",{className:"form-group",children:"\u306a\u306b\u306a\u306b\u3055\u3044\u3068\u304b\u3089\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3059\u304b\uff1f"}),Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("button",{onClick:function(){e.history.push("/")},className:"btn btn-info",style:{backgroundColor:"lightgray",borderColor:"lightgray"},children:"\u30ad\u30e3\u30f3\u30bb\u30eb"}),Object(k.jsx)("button",{onClick:function(){return function(e){e({type:d}),U.a.get("/api/users/logout").then((function(){e({type:O})})).catch((function(t){e({type:f,value:t.response?t.response.data.message:"errorMessage"})}))}(s)},className:"btn btn-info",children:"\u30ed\u30b0\u30a2\u30a6\u30c8"})]})]})};var q=function(){return Object(k.jsx)(o.a,{children:Object(k.jsxs)("div",{className:"container",children:[Object(k.jsx)(T,{}),Object(k.jsx)("br",{}),Object(k.jsx)(l.a,{path:"/",exact:!0,component:M}),Object(k.jsx)(l.a,{path:"/comment",component:A}),Object(k.jsx)(l.a,{path:"/user/signup",component:Q}),Object(k.jsx)(l.a,{path:"/user/mypage",component:K}),Object(k.jsx)(l.a,{path:"/user/login",component:Y}),Object(k.jsx)(l.a,{path:"/user/logout",component:J})]})})};c(89);r.a.render(Object(k.jsx)(L,{children:Object(k.jsx)(q,{})}),document.getElementById("root"))}},[[90,1,2]]]);
//# sourceMappingURL=main.3048b7d2.chunk.js.map